<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>3D Model Showcase</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <style>
    :root {
      --main-bg: #f5f7fa;
      --viewer-bg: #fff;
      --text-main: #222;
      --primary: #1976d2;
      --select-bg: #fff;
      --select-border: #bbb;
      --select-color: #222;
      --desc-color: #333;
      --shadow: 0 2px 16px #0001;
    }
    body.night {
      --main-bg: #181e28;
      --viewer-bg: #232b39;
      --text-main: #f3f6fa;
      --primary: #5caaff;
      --select-bg: #232b39;
      --select-border: #5caaff;
      --select-color: #f3f6fa;
      --desc-color: #a0bbd6;
      --shadow: 0 2px 16px #0004;
    }
    body {
      font-family: sans-serif;
      background: var(--main-bg);
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2em 0;
      color: var(--text-main);
      transition: background 0.35s, color 0.35s;
    }
    h1 {
      color: var(--primary);
      margin-bottom: 1em;
      transition: color 0.35s;
    }
    .controls {
      margin-bottom: 1.5em;
      display: flex;
      gap: 1em;
      flex-wrap: wrap;
      justify-content: center;
    }
    label {
      font-weight: bold;
      margin-right: 0.5em;
    }
    select {
      font-size: 1em;
      padding: 0.3em 0.7em;
      border-radius: 6px;
      border: 1px solid var(--select-border);
      background: var(--select-bg);
      color: var(--select-color);
      transition: background 0.35s, color 0.35s, border 0.35s;
    }
    model-viewer {
      width: 600px;
      height: 350px;
      background: var(--viewer-bg);
      border-radius: 12px;
      box-shadow: var(--shadow);
      margin-bottom: 2em;
      min-width: 250px;
      transition: background 0.35s, box-shadow 0.35s;
    }
    @media (max-width: 700px) {
      model-viewer { width: 99vw; height: 220px; }
    }
    .desc {
      font-size: 1.1em;
      color: var(--desc-color);
      margin-bottom: 2em;
      transition: color 0.35s;
    }
    .btn-bar {
      display: flex;
      gap: 1em;
      margin-bottom: 1.2em;
      justify-content: center;
    }
    .switch-btn {
      padding: 0.4em 1.2em;
      font-size: 1em;
      border-radius: 30px;
      border: 1.5px solid var(--primary);
      background: var(--viewer-bg);
      color: var(--primary);
      font-weight: 700;
      cursor: pointer;
      transition: background 0.2s, color 0.2s, border 0.2s;
      outline: none;
      box-shadow: 0 1px 4px #0002;
    }
    .switch-btn:active, .switch-btn:focus {
      background: var(--primary);
      color: var(--viewer-bg);
    }
    body.night .switch-btn {
      background: var(--viewer-bg);
      color: var(--primary);
      border-color: var(--primary);
    }
    body.night .switch-btn:active, body.night .switch-btn:focus {
      background: var(--primary);
      color: var(--viewer-bg);
    }
  </style>
</head>
<body>
  <h1 id="title">3D Model Showcase</h1>
  <div class="btn-bar">
    <button class="switch-btn" id="langSwitch" aria-label="Switch to Hebrew">ðŸ‡®ðŸ‡± ×¢×‘×¨×™×ª</button>
    <button class="switch-btn" id="nightSwitch" aria-label="Switch to Night Mode">ðŸŒ™ Night Mode</button>
  </div>
  <div class="controls">
    <div>
      <label for="category" id="label-category">Category:</label>
      <select id="category"></select>
    </div>
    <div>
      <label for="model" id="label-model">Model:</label>
      <select id="model"></select>
    </div>
  </div>
  <model-viewer
    id="viewer"
    camera-controls
    auto-rotate
    alt="3D model preview"
    shadow-intensity="1"
    ar
    ar-modes="scene-viewer webxr quick-look">
  </model-viewer>
  <div class="desc" id="desc"></div>
  <script>
    // Translations
    const translations = {
      en: {
        title: "3D Model Showcase",
        category: "Category:",
        model: "Model:",
        night: "ðŸŒ™ Night Mode",
        light: "â˜€ï¸ Light Mode",
        lang: "ðŸ‡®ðŸ‡± ×¢×‘×¨×™×ª",
        desc: (cat, model) => `Category: ${cat} | Model: ${model}`,
        pretty: (str) => str.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase())
      },
      he: {
        title: "×ª×¦×•×’×ª ×ž×•×“×œ×™× ×‘×ª×œ×ª-×ž×ž×“",
        category: "×§×˜×’×•×¨×™×”:",
        model: "×ž×•×“×œ:",
        night: "ðŸŒ™ ×ž×¦×‘ ×œ×™×œ×”",
        light: "â˜€ï¸ ×ž×¦×‘ ×™×•×",
        lang: "ðŸ‡¬ðŸ‡§ English",
        desc: (cat, model) => `×§×˜×’×•×¨×™×”: ${cat} | ×ž×•×“×œ: ${model}`,
        pretty: (str) => {
          // Hebrew pretty translation for known categories/models
          const cats = {
            "Cabinets": "××¨×•× ×•×ª",
            "Lamps": "×ž× ×•×¨×•×ª",
            "Sofas": "×¡×¤×•×ª",
            "Tables": "×©×•×œ×—× ×•×ª"
          };
          const mods = {
            "bookcase": "×›×•× × ×™×ª",
            "closet_oak_white": "××¨×•×Ÿ ×¢×¥ ×œ×‘×Ÿ",
            "ikea_alex_drawer": "×ž×’×™×¨×•×ª ××œ×›×¡ ××™×§××”",
            "floor_lamp": "×ž× ×•×¨×ª ×¨×¦×¤×”",
            "mario_floor_lamp": "×ž× ×•×¨×ª ×ž×¨×™×•",
            "sweep_floor_lamp_black": "×ž× ×•×¨×ª Sweep ×©×—×•×¨×”",
            "BLACKSofa": "×¡×¤×” ×©×—×•×¨×”",
            "dolton_armchair_hudson_grey": "×›×•×¨×¡× ×“×•×œ×˜×•×Ÿ ×”×“×¡×•×Ÿ ××¤×•×¨",
            "sofawood": "×¡×¤×ª ×¢×¥",
            "wassily_chair": "×›×™×¡× ×•××¡×™×œ×™",
            "kumo_white_coffee_table": "×©×•×œ×—×Ÿ ×§×¤×” ×œ×‘×Ÿ ×§×•×ž×•",
            "noguchi_coffee_table": "×©×•×œ×—×Ÿ ×§×¤×” × ×’×•×¦'×™"
          };
          return cats[str] || mods[str] ||
            str.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
        }
      }
    };
    let lang = "en";
    let modelsData = {};
    let currentCategory = "";
    let currentModelIndex = 0;

    function setLanguage(newLang) {
      lang = newLang;
      // Update all labels/texts
      document.getElementById('title').textContent = translations[lang].title;
      document.getElementById('label-category').textContent = translations[lang].category;
      document.getElementById('label-model').textContent = translations[lang].model;
      document.getElementById('langSwitch').textContent = translations[lang].lang;
      document.getElementById('langSwitch').setAttribute('aria-label',
        lang === "en" ? "Switch to Hebrew" : "Switch to English");
      // Night/Light button
      const isNight = document.body.classList.contains('night');
      document.getElementById('nightSwitch').textContent = isNight ? translations[lang].light : translations[lang].night;
      document.getElementById('nightSwitch').setAttribute('aria-label',
        isNight ? (lang === "en" ? "Switch to Light Mode" : "×”×—×œ×£ ×œ×ž×¦×‘ ×™×•×") :
                  (lang === "en" ? "Switch to Night Mode" : "×”×—×œ×£ ×œ×ž×¦×‘ ×œ×™×œ×”"));
      // Re-render dropdowns and desc
      renderCategoryDropdown();
      renderModelDropdown();
      updateViewer();
      // Direction for Hebrew
      document.body.dir = (lang === "he") ? "rtl" : "ltr";
    }

    function renderCategoryDropdown() {
      const catSel = document.getElementById('category');
      const cats = Object.keys(modelsData);
      catSel.innerHTML = '';
      cats.forEach(cat => {
        const opt = document.createElement('option');
        opt.value = cat;
        opt.textContent = translations[lang].pretty(cat);
        catSel.appendChild(opt);
      });
      catSel.value = currentCategory;
    }

    function renderModelDropdown() {
      const modelSel = document.getElementById('model');
      if (!modelsData[currentCategory]) return;
      modelSel.innerHTML = '';
      modelsData[currentCategory].forEach((model, i) => {
        const opt = document.createElement('option');
        opt.value = i;
        opt.textContent = translations[lang].pretty(model.name);
        modelSel.appendChild(opt);
      });
      modelSel.selectedIndex = currentModelIndex;
    }

    function updateViewer() {
      const viewer = document.getElementById('viewer');
      const desc = document.getElementById('desc');
      const modelObj = modelsData[currentCategory][currentModelIndex];
      viewer.src = modelObj.file;
      viewer.alt = translations[lang].pretty(modelObj.name);
      desc.textContent = translations[lang].desc(
        translations[lang].pretty(currentCategory),
        translations[lang].pretty(modelObj.name)
      );
    }

    document.getElementById('langSwitch').onclick = function() {
      setLanguage(lang === "en" ? "he" : "en");
    };

    document.getElementById('nightSwitch').onclick = function() {
      document.body.classList.toggle('night');
      // Update button text for the active language
      const isNight = document.body.classList.contains('night');
      document.getElementById('nightSwitch').textContent = isNight ? translations[lang].light : translations[lang].night;
    };

    document.getElementById('category').addEventListener('change', function() {
      currentCategory = this.value;
      currentModelIndex = 0;
      renderModelDropdown();
      updateViewer();
    });

    document.getElementById('model').addEventListener('change', function() {
      currentModelIndex = +this.value;
      updateViewer();
    });

    // Initial fetch and boot
    fetch('models.json')
      .then(r => r.json())
      .then(data => {
        modelsData = data;
        // Set defaults
        currentCategory = Object.keys(modelsData)[0];
        currentModelIndex = 0;
        setLanguage(lang);
      });
  </script>
</body>
</html>
